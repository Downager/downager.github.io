<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#222">
  <meta name="msapplication-config" content="/images/browserconfig.xml">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"blog.downager.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="Pre-configurations on the Palo Alto Networks Firewall1. Create New Device Admin Account (For Aruba) An Device Admin account must be created on the Palo Alto Networks firewall to allow the controller">
<meta property="og:type" content="article">
<meta property="og:title" content="[隨筆] Aruba Controller &amp; Palo Alto User-ID 整合筆記">
<meta property="og:url" content="https://blog.downager.com/2018/10/08/%E9%9A%A8%E7%AD%86-Aruba-Controller-Palo-Alto-User-ID-%E6%95%B4%E5%90%88%E7%AD%86%E8%A8%98/index.html">
<meta property="og:site_name" content="Relk&#39;s 工作手札">
<meta property="og:description" content="Pre-configurations on the Palo Alto Networks Firewall1. Create New Device Admin Account (For Aruba) An Device Admin account must be created on the Palo Alto Networks firewall to allow the controller">
<meta property="og:locale" content="zh_TW">
<meta property="og:image" content="https://blog.downager.com/2018/10/08/%E9%9A%A8%E7%AD%86-Aruba-Controller-Palo-Alto-User-ID-%E6%95%B4%E5%90%88%E7%AD%86%E8%A8%98/User-ID.png">
<meta property="article:published_time" content="2018-10-08T14:41:14.000Z">
<meta property="article:modified_time" content="2020-11-19T05:50:50.471Z">
<meta property="article:author" content="Relk Li">
<meta property="article:tag" content="隨筆">
<meta property="article:tag" content="Aruba">
<meta property="article:tag" content="Palo-Alto">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog.downager.com/2018/10/08/%E9%9A%A8%E7%AD%86-Aruba-Controller-Palo-Alto-User-ID-%E6%95%B4%E5%90%88%E7%AD%86%E8%A8%98/User-ID.png">

<link rel="canonical" href="https://blog.downager.com/2018/10/08/%E9%9A%A8%E7%AD%86-Aruba-Controller-Palo-Alto-User-ID-%E6%95%B4%E5%90%88%E7%AD%86%E8%A8%98/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-TW'
  };
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9305263519215553"
     crossorigin="anonymous"></script>
  <title>[隨筆] Aruba Controller & Palo Alto User-ID 整合筆記 | Relk's 工作手札</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-33010928-4"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-33010928-4');
      }
    </script>






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="Relk's 工作手札" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Relk's 工作手札</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">在 Cloud-Native 汪洋中載浮載沉的 SRE - Service Restart Engineer</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">67</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">10</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">53</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/downager" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://blog.downager.com/2018/10/08/%E9%9A%A8%E7%AD%86-Aruba-Controller-Palo-Alto-User-ID-%E6%95%B4%E5%90%88%E7%AD%86%E8%A8%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Relk Li">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Relk's 工作手札">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          [隨筆] Aruba Controller & Palo Alto User-ID 整合筆記
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-10-08 22:41:14" itemprop="dateCreated datePublished" datetime="2018-10-08T22:41:14+08:00">2018-10-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-11-19 13:50:50" itemprop="dateModified" datetime="2020-11-19T13:50:50+08:00">2020-11-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Networking/" itemprop="url" rel="index"><span itemprop="name">Networking</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2018/10/08/%E9%9A%A8%E7%AD%86-Aruba-Controller-Palo-Alto-User-ID-%E6%95%B4%E5%90%88%E7%AD%86%E8%A8%98/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/10/08/隨筆-Aruba-Controller-Palo-Alto-User-ID-整合筆記/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>3.6k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>7 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <img src="/2018/10/08/%E9%9A%A8%E7%AD%86-Aruba-Controller-Palo-Alto-User-ID-%E6%95%B4%E5%90%88%E7%AD%86%E8%A8%98/User-ID.png" class="">

<h1 id="Pre-configurations-on-the-Palo-Alto-Networks-Firewall"><a href="#Pre-configurations-on-the-Palo-Alto-Networks-Firewall" class="headerlink" title="Pre-configurations on the Palo Alto Networks Firewall"></a>Pre-configurations on the Palo Alto Networks Firewall</h1><h3 id="1-Create-New-Device-Admin-Account-For-Aruba"><a href="#1-Create-New-Device-Admin-Account-For-Aruba" class="headerlink" title="1. Create New Device Admin Account (For Aruba)"></a>1. Create New Device Admin Account (For Aruba)</h3><blockquote>
<p>An <strong>Device Admin</strong> account must be created on the Palo Alto Networks firewall to allow the controller to send data to it.<br>The built-in Admin account can be used for this purpose but that is not recommended.<br>It is better to create a new Admin account used solely for the purpose of communications between the controller and Palo Alto</p>
</blockquote>
<a id="more"></a> 
<h1 id="Aruba-Controller-Configuration-on-AOS-6-4"><a href="#Aruba-Controller-Configuration-on-AOS-6-4" class="headerlink" title="Aruba Controller Configuration on AOS 6.4"></a>Aruba Controller Configuration on AOS 6.4</h1><h3 id="1-Creating-the-Server-Profile-for-Palo-Alto-Network-on-the-Controller"><a href="#1-Creating-the-Server-Profile-for-Palo-Alto-Network-on-the-Controller" class="headerlink" title="1. Creating the Server Profile for Palo Alto Network on the Controller"></a>1. Creating the Server Profile for Palo Alto Network on the Controller</h3><blockquote>
<p><strong>To configure a new Palo Alto Networks profile</strong></p>
<ol>
<li>Navigate to Configuration &gt; Advanced Services &gt; All Profiles &gt; Other Profiles &gt; Palo Alto Networks Servers</li>
<li>Type the name of the profile and click Add</li>
<li>Click on the name of the profile created to open the Profile Details window</li>
<li>Enter the Host (IP address or hostname) of the Palo Alto Networks firewall</li>
<li>Enter the Port (1 – 65535) of the Palo Alto Networks Firewall<br>Note: The port used by default is 443</li>
<li>Enter the Username of the Palo Alto Networks firewall.<br>The user name is between 1 and 255 bytes in length and must match the Admin Account previously created on the Palo Alto Networks firewall.<br>Note: Refer to section 3.3</li>
<li>Enter the Password of the username in Palo Alto Networks Firewall. The password is between 6 and 100 bytes in length and must match the password of the Admin account previously created on the Palo Alto Networks firewall.</li>
<li>Re-enter the Password entered in the previous step</li>
<li>Click Add</li>
<li>Click Apply</li>
</ol>
</blockquote>
<h3 id="2-Activating-the-Palo-Alto-Networks-profile"><a href="#2-Activating-the-Palo-Alto-Networks-profile" class="headerlink" title="2. Activating the Palo Alto Networks profile"></a>2. Activating the Palo Alto Networks profile</h3><blockquote>
<p><strong>To apply a Palo Alto Networks Server profile on the local controller, complete the following steps:</strong></p>
<ol>
<li>Navigate to Configuration &gt; Advanced Services &gt; All Profiles &gt; Other Profiles &gt; Palo Alto Networks Active.</li>
<li>Select Active Palo Alto Networks. To the right of this link, the name of the active profile is displayed.</li>
<li>Other configured profile can be selected from the Active Palo Alto Networks Profile &gt; drop-down menu.<br>To configure a new profile, select NEW from the drop down menu and complete the configuration details.</li>
<li>Once a profile is selected from the drop-down menu or a new profile is created, click Apply. </li>
</ol>
</blockquote>
<h3 id="3-Enabling-the-Palo-Alto-Networks-Firewall-Integration"><a href="#3-Enabling-the-Palo-Alto-Networks-Firewall-Integration" class="headerlink" title="3. Enabling the Palo Alto Networks Firewall Integration"></a>3. Enabling the Palo Alto Networks Firewall Integration</h3><blockquote>
<p><strong>To enable a Palo Alto Netwokrs firewall integration in the AAA profile:</strong></p>
<ol>
<li>Navigate to Configuration &gt; Security &gt; Authentication &gt; AAA Profiles page</li>
<li>In the AAA Profiles Summary, select the desired profile</li>
<li>Check the PAN firewalls Integration check box</li>
<li>Click Apply</li>
</ol>
</blockquote>
<h1 id="Troubleshooting"><a href="#Troubleshooting" class="headerlink" title="Troubleshooting"></a>Troubleshooting</h1><h3 id="Q1-Timeout-Ping-不通"><a href="#Q1-Timeout-Ping-不通" class="headerlink" title="Q1. Timeout / Ping 不通"></a>Q1. Timeout / Ping 不通</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(Aruba7210) #ping &lt;pa_ip_addr&gt;</span><br><span class="line"></span><br><span class="line">Press &#39;q&#39; to abort.</span><br><span class="line">Sending 5, 92-byte ICMP Echos to &lt;pa_ip_addr&gt;, timeout is 2 seconds:</span><br><span class="line">.....</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(Aruba7210) #show pan state </span><br><span class="line"></span><br><span class="line">Palo Alto Networks Servers Connection State[PA5220]</span><br><span class="line">---------------------------------------------------</span><br><span class="line">Firewall          State</span><br><span class="line">--------          -----</span><br><span class="line">&lt;pa_ip_addr&gt;:443  DOWN[10&#x2F;08&#x2F;18 14:29:42]</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(Aruba7210) # show log system all | include |pan|</span><br><span class="line"></span><br><span class="line">Oct 8 14:39:27 :309109:  &lt;WARN&gt; |extifmgr| |pan| Session to PAN server [https:&#x2F;&#x2F;&lt;pa_ip_addr&gt;:443&#x2F;api&#x2F;] Failed - code:1004[Timeout was reached(28)]</span><br></pre></td></tr></table></figure>
<h4 id="檢查-PA-是否放行-Controller-IP-訪問管理介面"><a href="#檢查-PA-是否放行-Controller-IP-訪問管理介面" class="headerlink" title="檢查 PA 是否放行 Controller IP 訪問管理介面"></a>檢查 PA 是否放行 Controller IP 訪問管理介面</h4><blockquote>
<p>Device &gt; Setup &gt; Interfaces &gt; Management &gt; Add Permitted IP Addresses</p>
</blockquote>
<h3 id="Q2-憑證問題"><a href="#Q2-憑證問題" class="headerlink" title="Q2. 憑證問題"></a>Q2. 憑證問題</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(Aruba7210) # show log system all | include |pan|</span><br><span class="line"></span><br><span class="line">Oct 8 15:19:20 :309109:  &lt;WARN&gt; |extifmgr| |pan| Session to PAN server [https:&#x2F;&#x2F;&lt;pa_ip_addr&gt;:443&#x2F;api&#x2F;] Failed - code:1003[Peer certificate cannot be authenticated with given CA certificates(60)]</span><br></pre></td></tr></table></figure>

<h4 id="從-PA-上匯出憑證至-Aruba-Controller"><a href="#從-PA-上匯出憑證至-Aruba-Controller" class="headerlink" title="從 PA 上匯出憑證至 Aruba Controller"></a>從 PA 上匯出憑證至 Aruba Controller</h4><blockquote>
<p><strong>Palo Alto:</strong><br>Device &gt; Certificate Management &gt; Certificate &gt; Export Certificate</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Export Certificate</span><br><span class="line">File Format: Base64 Encoded Certificate (PEM)</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>Aruba Controller:</strong><br>Configuration &gt; Management &gt; Certificates &gt; Upload</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Upload a Certificate</span><br><span class="line">Certificate Format: PEM</span><br><span class="line">Certificate Type: Trusted CA</span><br></pre></td></tr></table></figure>

<p><strong>信任 CA 後依然顯示憑證有問題，嘗試以下做法</strong></p>
<blockquote>
<p><strong>Palo Alto 重新產生自簽證書</strong><br><strong><a href="https://www.paloaltonetworks.com/documentation/71/pan-os/pan-os/certificate-management/create-a-self-signed-root-ca-certificate" target="_blank" rel="noopener">Generate a Self-signed Root CA Certificate</a></strong></p>
<ol>
<li>Select Device &gt; Certificate Management &gt; Certificates &gt; Device Certificates.</li>
<li>If the firewall has more than one virtual system (vsys), select a Location (vsys or Shared) for the certificate.</li>
<li>Click Generate.</li>
<li>Enter a Certificate Name, such as GlobalProtect_CA. The name is case-sensitive and can have up to 31 characters. It must be unique and use only letters, numbers, hyphens, and underscores.</li>
<li>In the Common Name field, enter the FQDN (recommended) or IP address of the interface where you will configure the service that will use this certificate.</li>
<li>If the firewall has more than one vsys and you want the certificate to be available to every vsys, select the Shared check box.</li>
<li>Leave the Signed By field blank to designate the certificate as self-signed.</li>
<li>(Required) Select the Certificate Authority check box.</li>
<li>Leave the OCSP Responder field blank; revocation status verification doesn’t apply to root CA certificates.</li>
<li>Click Generate and Commit.</li>
</ol>
</blockquote>
<blockquote>
<p><strong>Palo Alto 證書替換管理流量證書（HTTPS）</strong><br><strong><a href="https://www.paloaltonetworks.com/documentation/71/pan-os/pan-os/certificate-management/replace-the-certificate-for-inbound-management-traffic" target="_blank" rel="noopener">Replace the Certificate for Inbound Management Traffic</a></strong></p>
<ol>
<li>Configure an SSL/TLS Service Profile.</li>
</ol>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Select Device &gt; Certificate Management &gt; SSL&#x2F;TLS Service Profile &gt; </span><br><span class="line">Add &gt; Select the Certificate you just obtained</span><br><span class="line">Protocol Min Version: TLSv1.1</span><br></pre></td></tr></table></figure>
<blockquote>
<ol start="2">
<li>Apply the SSL/TLS Service Profile to inbound management traffic.</li>
</ol>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Select Device &gt; Setup &gt; Management and edit the General Settings.</span><br><span class="line">Select the SSL&#x2F;TLS Service Profile you just configured.</span><br><span class="line">Click OK and Commit.</span><br></pre></td></tr></table></figure>

<h4 id="重新匯出剛剛新產生的憑證至-Aruba-Controller-並測試"><a href="#重新匯出剛剛新產生的憑證至-Aruba-Controller-並測試" class="headerlink" title="重新匯出剛剛新產生的憑證至 Aruba Controller 並測試"></a>重新匯出剛剛新產生的憑證至 Aruba Controller 並測試</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(Aruba7210) #show pan state </span><br><span class="line"></span><br><span class="line">Palo Alto Networks Servers Connection State[PA5220]</span><br><span class="line">---------------------------------------------------</span><br><span class="line">Firewall          State</span><br><span class="line">--------          -----</span><br><span class="line">&lt;pa_ip_addr&gt;:443  UP[10&#x2F;08&#x2F;18 16:42:21]Established</span><br></pre></td></tr></table></figure>

<h1 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h1><ul>
<li><a href="https://www.arubanetworks.com/pdf/partners/SG_PaloAltoNetworks.pdf" target="_blank" rel="noopener">Palo Alto Networks NextGeneration Firewall and Aruba WLAN Integration</a></li>
<li><a href="https://community.arubanetworks.com/t5/Wireless-Access/Troubleshoot-PAN-Integration/td-p/256433" target="_blank" rel="noopener">Troubleshoot PAN Integration</a></li>
<li><a href="https://www.paloaltonetworks.com/documentation/71/pan-os/pan-os/certificate-management/create-a-self-signed-root-ca-certificate" target="_blank" rel="noopener">Generate a Self-signed Root CA Certificate</a></li>
<li><a href="https://www.paloaltonetworks.com/documentation/71/pan-os/pan-os/certificate-management/replace-the-certificate-for-inbound-management-traffic" target="_blank" rel="noopener">Replace the Certificate for Inbound Management Traffic</a></li>
</ul>

    </div>

    
    
    
      
  <div class="popular-posts-header">Related Posts</div>
  <ul class="popular-posts">
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/2018/04/29/Aruba-Aruba-AP-故障更換紀錄/" rel="bookmark">[隨筆] Aruba AP 故障更換紀錄</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/2017/07/30/Windows-解決-Win10-安裝時無法選擇版本的問題/" rel="bookmark">[Windows] 解決 Win10 安裝時無法選擇版本的問題</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/2018/03/15/心得-uTorrent-無痛轉-qBittorrent-工具介紹/" rel="bookmark">[心得] uTorrent 無痛轉 qBittorrent 工具介紹</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/2018/03/24/翻牆-2018-ShadowsocksR-安裝及設定推薦/" rel="bookmark">[翻牆] 2018 ShadowsocksR 安裝及設定推薦</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/2018/03/22/記錄-WhatsUP-Gold-資料庫已滿處理方法/" rel="bookmark">[記錄] WhatsUP Gold 資料庫已滿處理方法</a></div>
    </li>
  </ul>

        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>作者:  </strong>Relk Li
  </li>
  <li class="post-copyright-link">
    <strong>文章連結: </strong>
    <a href="https://blog.downager.com/2018/10/08/%E9%9A%A8%E7%AD%86-Aruba-Controller-Palo-Alto-User-ID-%E6%95%B4%E5%90%88%E7%AD%86%E8%A8%98/" title="[隨筆] Aruba Controller &amp; Palo Alto User-ID 整合筆記">https://blog.downager.com/2018/10/08/隨筆-Aruba-Controller-Palo-Alto-User-ID-整合筆記/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版權聲明:  </strong>本網誌所有文章除特別聲明外，均採用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-TW" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 許可協議。轉載請註明出處！
  </li>
</ul>
</div>

        

  <div class="followme">
    <p>Welcome to my other publishing channels</p>

    <div class="social-list">

        <div class="social-item">
          <a target="_blank" class="social-link" href="https://twitter.com/relk_li">
            <span class="icon">
              <i class="fab fa-twitter"></i>
            </span>

            <span class="label">Twitter</span>
          </a>
        </div>

        <div class="social-item">
          <a target="_blank" class="social-link" href="https://t.me/relktalkshit">
            <span class="icon">
              <i class="fab fa-telegram"></i>
            </span>

            <span class="label">Telegram</span>
          </a>
        </div>

        <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
        </div>
    </div>
  </div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E9%9A%A8%E7%AD%86/" rel="tag"># 隨筆</a>
              <a href="/tags/Aruba/" rel="tag"># Aruba</a>
              <a href="/tags/Palo-Alto/" rel="tag"># Palo-Alto</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2018/08/05/Ubuntu-OpenVAS-9-%E5%AE%89%E8%A3%9D/" rel="prev" title="[Ubuntu] OpenVAS 9 安裝">
      <i class="fa fa-chevron-left"></i> [Ubuntu] OpenVAS 9 安裝
    </a></div>
      <div class="post-nav-item">
    <a href="/2018/11/25/%E9%9A%A8%E7%AD%86-Cisco-2960X-IOS-%E7%89%88%E6%9C%AC%E6%8C%91%E9%81%B8-%E6%9B%B4%E6%96%B0/" rel="next" title="[隨筆] Cisco 2960X IOS 版本挑選 & 更新">
      [隨筆] Cisco 2960X IOS 版本挑選 & 更新 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    
  <div class="comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
    </div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Pre-configurations-on-the-Palo-Alto-Networks-Firewall"><span class="nav-number">1.</span> <span class="nav-text">Pre-configurations on the Palo Alto Networks Firewall</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-Create-New-Device-Admin-Account-For-Aruba"><span class="nav-number">1.0.1.</span> <span class="nav-text">1. Create New Device Admin Account (For Aruba)</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Aruba-Controller-Configuration-on-AOS-6-4"><span class="nav-number">2.</span> <span class="nav-text">Aruba Controller Configuration on AOS 6.4</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-Creating-the-Server-Profile-for-Palo-Alto-Network-on-the-Controller"><span class="nav-number">2.0.1.</span> <span class="nav-text">1. Creating the Server Profile for Palo Alto Network on the Controller</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-Activating-the-Palo-Alto-Networks-profile"><span class="nav-number">2.0.2.</span> <span class="nav-text">2. Activating the Palo Alto Networks profile</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-Enabling-the-Palo-Alto-Networks-Firewall-Integration"><span class="nav-number">2.0.3.</span> <span class="nav-text">3. Enabling the Palo Alto Networks Firewall Integration</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Troubleshooting"><span class="nav-number">3.</span> <span class="nav-text">Troubleshooting</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Q1-Timeout-Ping-不通"><span class="nav-number">3.0.1.</span> <span class="nav-text">Q1. Timeout &#x2F; Ping 不通</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#檢查-PA-是否放行-Controller-IP-訪問管理介面"><span class="nav-number">3.0.1.1.</span> <span class="nav-text">檢查 PA 是否放行 Controller IP 訪問管理介面</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Q2-憑證問題"><span class="nav-number">3.0.2.</span> <span class="nav-text">Q2. 憑證問題</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#從-PA-上匯出憑證至-Aruba-Controller"><span class="nav-number">3.0.2.1.</span> <span class="nav-text">從 PA 上匯出憑證至 Aruba Controller</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#重新匯出剛剛新產生的憑證至-Aruba-Controller-並測試"><span class="nav-number">3.0.2.2.</span> <span class="nav-text">重新匯出剛剛新產生的憑證至 Aruba Controller 並測試</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#參考資料"><span class="nav-number">4.</span> <span class="nav-text">參考資料</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Relk Li"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Relk Li</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">53</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">67</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="mailto:YiJiun.Li.C@gmail.com" title="E-Mail → mailto:YiJiun.Li.C@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/relk_li" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;relk_li" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://t.me/relkli" title="Telegram → https:&#x2F;&#x2F;t.me&#x2F;relkli" rel="noopener" target="_blank"><i class="fab fa-telegram fa-fw"></i>Telegram</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.linkedin.com/in/relk-li/" title="Linkedin → https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;relk-li&#x2F;" rel="noopener" target="_blank"><i class="fab fa-linkedin fa-fw"></i>Linkedin</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2013 – 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Relk Li</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="Symbols count total">35k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">1:03</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://downager.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>
<script>
  var disqus_config = function() {
    this.page.url = "https://blog.downager.com/2018/10/08/%E9%9A%A8%E7%AD%86-Aruba-Controller-Palo-Alto-User-ID-%E6%95%B4%E5%90%88%E7%AD%86%E8%A8%98/";
    this.page.identifier = "2018/10/08/隨筆-Aruba-Controller-Palo-Alto-User-ID-整合筆記/";
    this.page.title = "[隨筆] Aruba Controller & Palo Alto User-ID 整合筆記";
    };
  NexT.utils.loadComments(document.querySelector('#disqus_thread'), () => {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: disqus_config
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://downager.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  });
</script>

</body>
</html>
